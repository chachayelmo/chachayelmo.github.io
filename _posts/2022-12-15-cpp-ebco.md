---
published: true
title:  "[C++] EBCO"
excerpt: "C++ì— ëŒ€í•´ ì•Œì•„ë³´ê¸°, EBCO"

categories:
  - Cpp
tags:
  - [C++, Cpp, Ebco]

toc: true
toc_sticky: true
author: chachayelmo
sitemap:
  changefreq : daily
  priority : 1.0
comment: true
date: 2022-12-14
last_modified_at: 2022-12-14
---

## 1. EBCO
- Empty Base Class Optimization
- emptyê°€ ê¸°ë°˜í´ë˜ìŠ¤ê°€ ë˜ë©´ í¬ê¸°ê°€ 0ìœ¼ë¡œ ê³„ì‚°

```cpp
#include <iostream> 
using namespace std; 
  
class Empty {}; 
  
class AAA 
{ 
  Empty a; 
  int b; 
}; 
  
class BBB : public Empty 
{ 
  int b; 
}; 
  
int main() 
{ 
  cout << sizeof(AAA) << endl; // 8 
  cout << sizeof(BBB) << endl; // 4, Emptyê°€ ê¸°ë°˜í´ë˜ìŠ¤ë¡œ ë„˜ì–´ì˜¤ë©´ í¬ê¸°ê°€ 0 
}
```

```cpp
#include <iostream> 
#include <type_traits> 
using namespace std; 
  
struct EMPTY {}; 
  
template<typename T, typename U> struct PAIR : T 
{ 
  U v2; 
  T& getValue1() { return *this; } 
  U& getValue2() { return v2; } 

  PAIR() = default; 

  template<typename A, typename B> 
  PAIR(A&& a, B&& b) 
      : T(std::forward<A>(a)), v2(std::forward<B>(b)) {} 
}; 
  
int main() 
{ 
  //PAIR<int, int> p; 
  PAIR<EMPTY, int> p; 
  cout << sizeof(p) << endl; // 4
}
```

```cpp
#include <iostream> 
#include <type_traits> 
using namespace std; 
  
struct EMPTY {}; 
  
template<typename T, typename U, bool b = is_empty<T>::value> 
struct PAIR 
{}; 
  
// PAIR<int,int> 
// PAIR<EMPTY,int> 
  
// boostê°€ ì œì•ˆí•œ compressed pair ë¼ì´ë¸ŒëŸ¬ë¦¬
template<typename T, typename U> struct PAIR<T, U, false> 
{ 
  T v1; 
  U v2; 
  T& getValue1() { return v1; } 
  U& getValue2() { return v2; } 

  PAIR() = default; 

  template<typename A, typename B> 
  PAIR(A&& a, B&& b) 
      : v1(std::forward<A>(a)), v2(std::forward<B>(b)) {} 
}; 
  
template<typename T, typename U> struct PAIR<T, U, true> : T 
{ 
  U v2; 
  T& getValue1() { return *this; } 
  U& getValue2() { return v2; } 

  PAIR() = default; 

  template<typename A, typename B> 
  PAIR(A&& a, B&& b) 
      : T(std::forward<A>(a)), v2(std::forward<B>(b)) {} 
}; 
  
int main() 
{ 
  PAIR<int, int> p1; 
  PAIR<EMPTY, int> p2; 
  cout << sizeof(p1) << endl; // 8 
  cout << sizeof(p2) << endl; // 4 
}
```

## ì°¸ê³ 
codenuri ê°•ì„ë¯¼ ê°•ì‚¬ ê°•ì˜ ë‚´ìš©ê¸°ë°˜ìœ¼ë¡œ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.  
[ì½”ë“œëˆ„ë¦¬](https://github.com/codenuri)  

<br>

    This is personal diary for study documents.
    Please comment if I'm wrong or missing something else ğŸ˜„. 

[Top](#){: .btn .btn--primary }{: .align-right}